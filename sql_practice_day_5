# FUNCTIONS, 
SELECT *
FROM SALES1 S1;

# FUNCTIONS 

DELIMITER &&
CREATE FUNCTION ADD_TO_COL(A INT)
RETURNS INT 
DETERMINISTIC
BEGIN 
	DECLARE B INT;
    SET B = A + 10;
    RETURN B;
END &&

SELECT MAX(S1.SALES)
FROM SALES1 S1;

SELECT S1.SHIPPING_COST AS SHIPPING_COST,
ADD_TO_COL(S1.SHIPPING_COST) AS NEW_SHIPPING_COST,
S1.QUANTITY AS PREV_QTY,
ADD_TO_COL(S1.QUANTITY) AS NEW_QTY
FROM SALES1 S1 

DELIMITER &&
CREATE FUNCTION FINAL_PROFIT(PROFIT INT, DISCOUNT INT)
RETURNS INT 
DETERMINISTIC
BEGIN 
	DECLARE FINAL_PROFIT INT;
    SET FINAL_PROFIT = PROFIT - DISCOUNT;
    RETURN FINAL_PROFIT;
END &&

SELECT S1.PROFIT, S1.DISCOUNT , FINAL_PROFIT(S1.PROFIT,S1.DISCOUNT) AS FINAL_PROFIT
FROM
SALES1 S1 ;

DELIMITER &&
CREATE FUNCTION REAL_DISCOUNT(DISCOUNT INT, SALES INT)
RETURNS INT 
DETERMINISTIC 
BEGIN
	DECLARE REAL_DISCOUNT INT;
    SET REAL_DISCOUNT = SALES * DISCOUNT;
    RETURN REAL_DISCOUNT;
END &&

SELECT S1.DISCOUNT, S1.SALES, REAL_DISCOUNT(S1.DISCOUNT, S1.SALES)
FROM SALES1 S1 


delimiter &&
create function final_profits_real(profit int, discount decimal(8,4), sales int)
returns int
deterministic
begin
declare final_profits_real int;
set final_profits_real = profit - sales * discount;
return final_profits_real;
end &&;

SELECT PROFIT,DISCOUNT,SALES,FINAL_PROFITS_REAL(PROFIT,DISCOUNT,SALES) AS FINAL_PROFITS_REAL
FROM SALES1 S1;

# CONVERT SOME OF INTEGER DATA INTO VARCHAR/STRING 

DELIMITER &&
CREATE FUNCTION INT_TO_VARCHAR(VAR INT)
RETURNS VARCHAR(30)
deterministic
BEGIN 
	DECLARE INPUT INT ;
    SET INPUT = VAR;
    RETURN VAR;
END &&
SELECT INT_TO_VARCHAR(5666);


# MARK 
SELECT MAX(SALES), MIN(SALES)
FROM SALES1;
/*
1 - 100 - SUPER AFFORDABLE PRODUCT
100 - 300 - AFFORDABLE 
300 - 600 - MODERATE PRICE 
600+ - EXPENSIVE 
*/
# CONDITIONAL STATEMENTS 
DELIMITER &&
CREATE FUNCTION MARK_SALES(VAR INT)
RETURNS VARCHAR(30)
deterministic
BEGIN
	DECLARE FLAG VARCHAR(30);
    IF VAR < 100 THEN 
		SET FLAG = 'SUPER AFFORDABLE PRODUCT';
    ELSEIF VAR > 100 AND VAR < 300 THEN
		SET FLAG = 'AFFORDABLE';
	ELSEIF VAR > 300 AND VAR < 600 THEN
		SET FLAG = 'MODERATE PRICE';
	ELSEIF VAR > 600 THEN
		SET FLAG = 'EXPENSIVE';
	ELSE 
		SET FLAG = 'NOTHING';
	END IF;
    RETURN FLAG;
END &&

SELECT S1.SALES, MARK_SALES(S1.SALES)
FROM SALES1 S1 ;

SELECT MARK_SALES(1500);

SELECT MARK_SALES(300);

ALTER TABLE SALES1
ADD COLUMN MARK_SALES VARCHAR(30);

UPDATE SALES1 S1
SET S1.MARK_SALES = MARK_SALES(S1.SALES);
